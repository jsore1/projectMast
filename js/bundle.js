!function(){"use strict";function e(e,t){return new Promise(((n,o)=>{const d=document.createElement("div");d.classList.add("modal__image-card"),t.prepend(d);const a=document.createElement("img");a.onload=()=>n(a),a.classList.add("modal__img"),d.prepend(a),a.setAttribute("src",e)}))}function t(e){document.querySelector(e).classList.add("show")}function n(e){document.querySelector(e).classList.remove("show"),document.querySelector(".modal__image-inner").style.transition="none"}function o(n,o,d){const a=document.querySelector(".modal__text"),l=document.querySelector(".modal__title"),r=document.querySelector(".modal__date"),c=document.querySelector(".modal__image-inner"),s=document.querySelector(".modal__next"),i=document.querySelector(".modal__back"),m=document.querySelector(".loader"),u=[];document.querySelectorAll(".modal__image-card").forEach((e=>{e.remove()})),a.classList.add("hide"),l.textContent=n[o-1].title,r.textContent=d[0].description,c.style.width=100*d.length+"%",m.classList.add("show"),d.length>1?(d.forEach(((t,n)=>{u.push(e(d[n].url,c))})),Promise.all(u).then((()=>{m.classList.remove("show"),t(".modal"),function(e){const t=window.getComputedStyle(document.querySelector(".modal__image-wrapper")).width,n=document.querySelector(".modal__next"),o=document.querySelector(".modal__back"),d=document.querySelector(".modal__image-inner"),a=document.querySelector(".modal__date");n.classList.remove("hide"),o.classList.remove("hide");let l=+t.slice(0,t.length-2)*(e.length-1),r=0;d.style.transform=`translateX(-${l}px)`,n.addEventListener("click",(()=>{d.style.transition="0.5s all",+l.toFixed(1)==+(+t.slice(0,t.length-2)*(e.length-1)).toFixed(1)?(l=0,r=e.length-1):(l+=+t.slice(0,t.length-2),r-=1),d.style.transform=`translateX(-${l}px)`,a.textContent=e[r].description})),o.addEventListener("click",(()=>{d.style.transition="0.5s all",0==l?(l=+t.slice(0,t.length-2)*(e.length-1),r=0):(l-=+t.slice(0,t.length-2),r+=1),d.style.transform=`translateX(-${l}px)`,a.textContent=e[r].description}))}(d)}))):e(d[0].url,c).then((()=>{c.style.transform="none",s.classList.add("hide"),i.classList.add("hide"),m.classList.remove("show"),t(".modal")}))}function d(){fetch("select_points.php",{method:"POST"}).then((e=>e.json())).then((e=>{!function(e,t){if(e.length>0){const t=document.querySelector(".plan");e.forEach((e=>{t.insertAdjacentHTML("beforeend",`<div class="plan__point" style="top: ${e.y}px;left: ${e.x}px" data-id="${e.id}">\n                    ${e.name}\n                </div>`)}))}}(e),function(e,t,n){let d=!1,a=!1;const l=document.getElementById("add-point"),r=document.getElementById("update-point");l.addEventListener("change",(()=>{d=l.checked})),r.addEventListener("change",(()=>{a=r.checked}));const c=document.querySelector(t);c.addEventListener("click",(t=>{const l=+t.target.getAttribute("data-id");if(a&&t.target&&t.target.className===n){let e=new Date,n=e.getDate()>9?`${e.getDate()}`:`0${e.getDate()}`,o=e.getMonth()+1>9?`${e.getMonth()+1}`:`0${e.getMonth()+1}`;if(t.preventDefault(),confirm("Обновить точку?")){const t=prompt("Введите дату фото",`Дата съемки: ${n}.${o}.${e.getFullYear()}`),d=prompt("Введите путь к фото",`images/photo_${n}_${o}_${e.getFullYear()}/`);if(null===t||null===d)return;!function(e,t,n){let o=new FormData;o.append("id",e),o.append("description",t),o.append("url",n),fetch("update_point.php",{method:"POST",body:o}).then((e=>e.text())).then((e=>{"1"===e&&console.log("Точка обновлена!")}))}(l,t,d)}}else if(d&&t.target&&"IMG"===t.target.tagName){if(confirm("Добавить новую точку на план?")){let e=new Date;const n=t.offsetY-10,o=t.offsetX-10,d=prompt("Введите имя для точки","имя точки"),a=prompt("Введите название для фото","название фото"),l=prompt("Введите дату фото",`Дата съемки: ${e.getDate()}.${+e.getMonth()+1}.${e.getFullYear()}`),r=prompt("Введите путь к фото",`images/photo_${e.getDate()}_${+e.getMonth()+1}_${e.getFullYear()}/`);if(null===d||null===a||null===l||null===r)return;!function(e,t,n,o,d,a,l){let r=new FormData;r.append("x",e),r.append("y",t),r.append("name",n),r.append("title",o),r.append("date",d),r.append("url",a),fetch("add_point.php",{method:"POST",body:r}).then((e=>e.text())).then((o=>{"1"===o&&(console.log("Точка добавлена!"),l.insertAdjacentHTML("beforeend",`<div class="plan__point" style="top: ${t}px;left: ${e}px" data-id="">\n                        <span>${n}</span>\n                    </div>`))}))}(o,n,d,a,l,r,c)}}else t.target&&t.target.className===n&&function(e,t){let n=new FormData;n.append("id",e),fetch("select_images_archive.php",{method:"POST",body:n}).then((e=>e.json())).then((n=>{n.reverse(),n.push({url:t[e-1].url,description:t[e-1].date}),o(t,e,n.reverse())}))}(l,e)}))}(e,".plan","plan__point")}))}window.addEventListener("DOMContentLoaded",(()=>{d(),fetch("get_table.php",{method:"POST"}).then((e=>e.json())).then((e=>{const t=document.querySelector(".main-table").children[0].children[1];e.reverse().forEach(((e,n)=>{const o=`<tr>\n                            <td>${e.date}</td>\n                            <td>${e.numberObject}</td>\n                            <td>${e.description}</td>\n                            <td>${e.secondName}</td>\n                        </tr>`;t.insertAdjacentHTML("beforeend",o)}))})),function(){const e=document.querySelector(".modal");document.querySelector(".modal__close").addEventListener("click",(()=>n(".modal"))),e.addEventListener("click",(t=>{t.target===e&&n(".modal")}))}()}))}();
//# sourceMappingURL=bundle.js.map